<!DOCTYPE html>
<html>
	<head>
		<title>A9 Đan Phượng Login</title>
		
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-auth.js"></script>

<meta name=viewport content="width=device-width, initial-scale=1.0" charset=utf-8>

<script src="https://www.gstatic.com/firebasejs/7.1.0/firebase-database.js"></script>

<script src="/lb/my.js"></script>
<script src="/lb/view.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<link rel=stylesheet href=/lb/bootstrap.min.css></link>
<script src="/lb/md5.js"></script>
<script src="/lb/jquery.min.js"></script>
<script src="/lb/bootstrap.min.js"></script>
<script>
  
</script>
		
	</head>
	<body>

	<nav class="navbar navbar-expand-lg navbar-dark">
  <a class="navbar-brand" href="#">A9dp Dev</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="./index.html">Công khai</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./private.html">Nội bộ</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link active">Đăng nhập</a>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="chat-group.html">Nhóm chat (đang phát triển)</a>
      </li>
    </ul>
  </div>
</nav>
	
	<div id=page-loggined>
		<div>
		<button class='btn btn-lg btn-primary' id=logout>
			<span class=h6>
				Logged!!
			</span>
			<br>
			<small class='h7 small'>Tap to button with logout!</small>
		</button>
		</div>
	</div>

  <div id=page-login class="container">
	<div class="row">
	  <div class="col-sm-9 col-md-7 col-lg-5 mx-auto">
		<div class="card card-signin my-5">
		  <div class="card-body">
			<h5 class="card-title text-center">Sign In</h5>
			<form class="form-signin">
			  <div class="form-label-group">
				<input type="text" id="inputEmail" class="form-control" placeholder="Email address" required autofocus>
				<label for="inputEmail">Email address</label>
			  </div>

			  <div class="form-label-group">
				<input type="password" id="inputPassword" class="form-control" placeholder="Password" required>
				<label for="inputPassword">Password</label>
			  </div>

			  <div class="custom-control custom-checkbox mb-3">
				<input type="checkbox" class="custom-control-input" id="customCheck1">
				<label class="custom-control-label" for="customCheck1">Remember password</label>
			  </div>
			  <button class="btn btn-lg btn-primary btn-block text-uppercase" type="submit">Sign in</button><!--
			  <hr class="my-4">
			  <button class="btn btn-lg btn-google btn-block text-uppercase" type="submit"><i class="fab fa-google mr-2"></i> Sign in with Google</button>
			  <button class="btn btn-lg btn-facebook btn-block text-uppercase" type="submit"><i class="fab fa-facebook-f mr-2"></i> Sign in with Facebook</button>-->
				<div id=message class=small hidden>
					
				</div>
			</form>
		  </div>
		</div>
	  </div>
	</div>
  </div>

	
	<style type=text/css>
:root {
  --input-padding-x: 1.5rem;
  --input-padding-y: .75rem;
}

body {
  background: #007bff;
  background: linear-gradient(to right, #0062E6, #33AEFF);
}
.background {
  background: #007bff;
  background: linear-gradient(to right, #0062E6, #33AEFF);
}
.card-signin {
  border: 0;
  border-radius: 1rem;
  box-shadow: 0 0.5rem 1rem 0 rgba(0, 0, 0, 0.1);
}

.card-signin .card-title {
  margin-bottom: 2rem;
  font-weight: 300;
  font-size: 1.5rem;
}

.card-signin .card-body {
  padding: 2rem;
}

.form-signin {
  width: 100%;
}

.form-signin .btn {
  font-size: 80%;
  border-radius: 5rem;
  letter-spacing: .1rem;
  font-weight: bold;
  padding: 1rem;
  transition: all 0.2s;
}

.form-label-group {
  position: relative;
  margin-bottom: 1rem;
}

.form-label-group input {
  height: auto;
  border-radius: 2rem;
}

.form-label-group>input,
.form-label-group>label {
  padding: var(--input-padding-y) var(--input-padding-x);
}

.form-label-group>label {
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  width: 100%;
  margin-bottom: 0;
  /* Override default `<label>` margin */
  line-height: 1.5;
  color: #495057;
  border: 1px solid transparent;
  border-radius: .25rem;
  transition: all .1s ease-in-out;
}

.form-label-group input::-webkit-input-placeholder {
  color: transparent;
}

.form-label-group input:-ms-input-placeholder {
  color: transparent;
}

.form-label-group input::-ms-input-placeholder {
  color: transparent;
}

.form-label-group input::-moz-placeholder {
  color: transparent;
}

.form-label-group input::placeholder {
  color: transparent;
}

.form-label-group input:not(:placeholder-shown) {
  padding-top: calc(var(--input-padding-y) + var(--input-padding-y) * (2 / 3));
  padding-bottom: calc(var(--input-padding-y) / 3);
}

.form-label-group input:not(:placeholder-shown)~label {
  padding-top: calc(var(--input-padding-y) / 3);
  padding-bottom: calc(var(--input-padding-y) / 3);
  font-size: 12px;
  color: #777;
}

.btn-google {
  color: white;
  background-color: #ea4335;
}

.btn-facebook {
  color: white;
  background-color: #3b5998;
}

/* Fallback for Edge
-------------------------------------------------- */

@supports (-ms-ime-align: auto) {
  .form-label-group>label {
	display: none;
  }
  .form-label-group input::-ms-input-placeholder {
	color: #777;
  }
}

/* Fallback for IE
-------------------------------------------------- */

@media all and (-ms-high-contrast: none),
(-ms-high-contrast: active) {
  .form-label-group>label {
	display: none;
  }
  .form-label-group input:-ms-input-placeholder {
	color: #777;
  }
}

#page-login {
	display: none;
}
#page-loggined {
	display: none;
	justify-content: center;
	align-items: center;
	-webkit-justify-content: center;
	-webkit-align-items: center;
}
#page-loggined > div {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%);
}
	</style>
	<script type=text/javascript>
// Your web app's Firebase configuration
/*
  var firebaseConfig = {
    apiKey: "AIzaSyDtQqBD6qgdOc4obeXF2remLKccEQx566s",
    authDomain: "languages-rate.firebaseapp.com",
    databaseURL: "https://languages-rate.firebaseio.com",
    projectId: "languages-rate",
    storageBucket: "languages-rate.appspot.com",
    messagingSenderId: "23037787959",
    appId: "1:23037787959:web:e25d284d23287eef7064b2"
  };*/
  // Initialize Firebase
  console.warn = console.error = console.log
var cookie = device.cookie
  var firebaseConfig = {
	apiKey: "AIzaSyATsprQmBaksAg7ZPoGGejFTLWclLP576Y",
	authDomain: "glass-gasket-254006.firebaseapp.com",
	databaseURL: "https://glass-gasket-254006.firebaseio.com",
	projectId: "glass-gasket-254006",
	storageBucket: "glass-gasket-254006.appspot.com",
	messagingSenderId: "883400548883",
	appId: "1:883400548883:web:61d2e40bfa097c9ba4d5e6",
	measurementId: "G-GZ498J99QG"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

var database = firebase.database()

if (cookie && cookie.get('username') && cookie.get('pass')) {
	database.ref('accounts/')
	.once('value')
	.then(function (e) {
		var val = e.val()
		
		var success = false;

		my.each(val, function (key, val) {
			if (val.username.toLowerCase() === cookie.get('username').toLowerCase() && cookie.get('pass') === val.pass) {
				success = true
			}
		})
		
		if (success) {
			my('#page-loggined')
				.display('block')
			my('#page-login')
				.display('none')
		}
		
		else {
			my('#page-login')
			.display('block')
			my('#page-loggined')
				.display('none')
		}
		
	})
	my('#logout').click(function (){

sessionStorage.removeItem('username')
					sessionStorage.removeItem('pass')
		cookie.remove('username pass')
		my('#page-login')
			.display('block')
		my('#page-loggined')
			.display('none')
	})
}
else {
	my('#page-login')
			.display('block')
	my('#page-loggined')
			.display('none')
}

my('form').submit(function (e) {
	e.preventDefault()
	
	var email = my('#inputEmail').val()
	var pass = md5(my('#inputPassword').val())
	var remember = my('#customCheck1').get(0).checked

	database.ref('accounts/')
	.once('value')
	.then(function (e) {
		var val = e.val()
		
		var success = false;

		my.each(val, function (key, val) {
			if (val.username.toLowerCase() === email.toLowerCase() && pass === val.pass) {
				success = true
			}
				
		})
		
		if (success === true) {
			my('#message')
			.unAttr('hidden')
			.text('Login successfully')
			.removeClass()
			.addClass('text-success')
			setTimeout(function () {
			sessionStorage.setItem('username', email)
					sessionStorage.setItem('pass', pass)

			})
			
			if (remember) {
				cookie.set('username', email, '+30day').set('pass', pass, '+30day')
			}
			
			my('<a href=./index.html>').appendTo('body').click()

		}
		else {
			my('#message')
			.unAttr('hidden')
			.text('Login successfully')
			.removeClass()
			.addClass('text-danger')
		}
		
	})
	
})

/*
my('form').submit(function (e) {
	e.preventDefault()
	
	var email = my('#input-email').val()
	var pass = my('#input-password').val()
	var remember = my('#remember')[0].checked
	
	console.log(email)
})
*/
/*
firebase.database().ref('accounts/')
.once('value').then(function (e) {
	console.log(e.val())
})*/
/*


database.ref('accounts/').push({
	username: 'thanhdev',
	pass: md5('Thanhbanh'),
	premier: 'admin'
})
.catch(e => console.log(e + ''))
.then(function () {console.log(1)})
*/
/*
.catch ((e) => {
	console.log(e + '')
})
database.ref('post/').on('child_added', function (e) {
	console.log(e.val())
})*/
//my('body').view(database.ref('/'))
//console.log(database.ref('/') + '')
	</script>
	</body>
</html>
